stages:  
  - build

debian-package:  
  stage: build
  image: debian:bullseye
  script:
    - apt update
    - apt install -y dh-make dh-exec
    - dpkg-buildpackage -us -uc
    - mkdir build
    - mv ../agdsn-zsh-config*.deb build/
  # The files which are to be made available in GitLab
  artifacts:
    paths:
      - build/*
    expire_in: 1 week

rpm-package:
  stage: build
  image: rockylinux:8
  script:
    - dnf install -y rpm-build
    - rpmbuild -bb rpm/agdsn-zsh-config.spec \
      --define "_topdir $(pwd)/rpm/build" \
      --define "_sourcedir $(pwd)"
    - mkdir build
    - mv rpm/build/RPMS/noarch/agdsn-zsh-config*.rpm build/
  artifacts:
    paths:
      - build/*
    expire_in: 1 week
